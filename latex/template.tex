% Template adapted from https://github.com/sylvainschmitt/PhD/tree/master/documents/thesis/latex/template.latex

%%% STYLE %%%
\documentclass[12pt,twoside,a4paper, a$if(lang)$$babel-lang$,$endif$$if(papersize)$$papersize$paper,$endif$$for(classoption)$$classoption$$sep$,$endfor$]{$documentclass$}



%%% PACKAGES %%%

% fonts
\usepackage{lmodern}
% \usepackage{anyfontsize}

\usepackage{lipsum}

% pdf
\usepackage{pdfpages}

% formulae
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Tables
$if(tables)$
% pacakges for kableextra
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
% \usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{long table}}{}
$endif$

% graphics
$if(graphics)$
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
$endif$

% indent
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}

% prevent overfull lines
\setlength{\emergencystretch}{3em}  
\providecommand{\tightlist}{%
\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\setcounter{secnumdepth}{0}

% set default figure placement to htbp
\makeatletter 
\def\fps@figure{htbp}
\makeatother

% set default table placement to htbp
\makeatletter 
\def\fps@table{htbp}
\makeatother

% code highlights
$if(highlighting-macros)$
$highlighting-macros$
$endif$

% background image added by V.V.
\usepackage{eso-pic}
\newcommand\BackgroundIm{
\put(0,0){
  \parbox[b][\paperheight]{\paperwidth}{%
    \vfill
    \centering
    \includegraphics[height=\paperheight,width=\paperwidth]{img/background.jpg}%
    \vfill
}}}

% packages added by V.V.
\usepackage{lettrine}
\usepackage{caption}

% For Pandoc 2.11+, added by V.V. from thesisdown
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
  % set entry spacing
  \ifnum #2 > 0
  \setlength{\parskip}{#2\baselineskip}
  \fi
 }%
 {}
 
% To pass between YAML and LaTeX, added by V.V. from thesisdown
\def\title#1{\def\title{#1}}
\title{$title$}
\def\author#1{\def\author{#1}}
\author{$author$}
\def\date#1{\def\date{#1}}
\date{$date$}
\def\supervisor#1{\def\supervisor{#1}}
\supervisor{$supervisor$}
\def\specialty#1{\def\specialty{#1}}
\specialty{$specialty$}
\def\department#1{\def\department{#1}}
\department{$department$}

% paragraphs
% beware this make the toc bug if hyperref is placed before
\usepackage{titlesec}
\let\oldsection\section
\renewcommand\section{\clearpage\oldsection}
\titleformat{\section}
{\huge\center\scshape}{\thesection}{1em}{}[{\titlerule[0.5pt]}]
\titleformat*{\subsection}{\LARGE\bfseries}
\titleformat*{\subsubsection}{\Large\bfseries}
\titleformat*{\paragraph}{\large\bfseries\itshape}
\titleformat*{\subparagraph}{\normalsize\itshape}

% hyperlinks (cleverref and colors for UM added by V.V.)
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{%
\usepackage[$for(microtypeoptions)$$microtypeoptions$$sep$,$endfor$]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
$if(verbatim-in-note)$
  \usepackage{fancyvrb}
$endif$
\usepackage[unicode=true]{hyperref}
$if(colorlinks)$
  \PassOptionsToPackage{usenames,dvipsnames}{color} % color is loaded by hyperref
$endif$
\definecolor{um-red}{RGB}{233,78,82}
\definecolor{um-gray}{RGB}{114,146,162}
\hypersetup{
  $if(colorlinks)$
    colorlinks=true,
    linkcolor=um-red,
    citecolor=um-red,
    urlcolor=um-gray,
  $else$
    pdfborder={0 0 0},
  $endif$
    breaklinks=true}
\urlstyle{same} % don't use monospace font for urls
$if(verbatim-in-note)$
\VerbatimFootnotes % allows verbatim text in footnotes
$endif$
\usepackage[capitalise, nameinlink]{cleveref}

% empty all blank pages created by \cleardoublepage, added by V.V.
\usepackage{emptypage}

% geometry
\usepackage[left=2.5cm,right=2.5cm,top=2cm,bottom=2cm]{geometry}
\renewcommand{\baselinestretch}{1.1}

% Bibliography
\usepackage{natbib}
\bibliographystyle{plainnat}

% citations
\usepackage{epigraph}

%%% BODY %%%
\begin{document}

% First pages
$for(include-before)$
  $include-before$
$endfor$
% 
% \tableofcontents
% \listoftables
% \listoffigures

$body$

% \addcontentsline{toc}{section}{References}
\bibliography{$bibliography$}
% \listoftables
% \listoffigures

% Last pages
$for(include-after)$
  $include-after$
$endfor$

\end{document}
